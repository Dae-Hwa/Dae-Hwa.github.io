{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/2021-08-09--get-메소드의-body/index.md/","result":{"data":{"site":{"siteMetadata":{"disqus":"gatsby-typescript"}},"post":{"html":"<p>현재 WAS 만들기 프로젝트를 진행하고 있다. 당연히 request와 response도 직접 처리하는데, 큰 고민이 생겼다. 'GET 메소드에는 request Body를 넣으면 안 되는 것인가?' 에 관한 것이었다.</p>\n<p>문제 상황은 다음과 같다.</p>\n<ul>\n<li>POST 메소드로 만들어야 되는 기능인데, GET메소드도 받을 수 있도록 되어 있다.</li>\n<li>\n<p>POST 메소드에는 리퀘스트 바디가 있지만, GET메소드에는 리퀘스트 바디가 존재하지 않는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GetMessage</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">RequestMessage</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">private</span> <span class=\"token class-name\">RequestHeader</span> header<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PostMessage</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">RequestMessage</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">private</span> <span class=\"token class-name\">RequestHeader</span> header<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">private</span> <span class=\"token class-name\">Body</span> body<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n</li>\n<li>\n<p>이 경우 GET 메소드로는 정상적인 프로세스 진행이 불가능하다.</p>\n<blockquote>\n<p>엄밀히 말하면, 브라우저나 일반적인 요청에서는 대부분 GET 메소드의 경우 파라미터를 쿼리 스트링에 붙여서 오도록 수정해준다. 따라서 해당 경우가 생기지 않을 가능성도 있다. 하지만, 단위 테스트를 작성하던 중 이상한 점을 발견했다.</p>\n</blockquote>\n</li>\n</ul>\n<p>Spring의 RequestMapping의 메소드 타입을 등록하지 않은 경우와 같은 경우가 되겠다.</p>\n<p>하지만, 우리는 GET 메소드는 URL을 이용해서 데이터를 주고받고, POST 메소드는 body에 데이터를 담아서 전송한다고 알고 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3a9cb19836ad613d4cdd288012acfabc/e9d87/Get-Method.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.20809248554913%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABYkAAAWJAGbFcYUAAABqklEQVQoz5VT246bMBD1/39LfiJSH6qq6iVpCMRJCJtAwLexDSyYWzoOWm2qTSt1dDQ+c+TxjM1AFovFcrls2/Z2u03TdPsfIz9XqziOrbVN09R13XXda9O0zs0hHuqca701r3ebxaqq+74nnDMNIIVAr5QqrcW1rkqtQUpRld601qgbXPwWiRS96xwBW3XD2I2T6wckbT+4N+96xNB6jD7EbcPUzfow9sNINuHux3qz2myvXChtudIeoAW8E4TU5srEMTnPIvpUaPIrpOsg3ER0d4ivXHIApp4BIGM8zdkccgUvDEhAD0FEg2gX7GjOpASDDXwE6jkTOZe+EQyVvnAgn7enpJCmrJQpxVuTH3Fvm2M+Eh+CPmPyp/X+cMETIeeqEFDI52BYKudpIbDnWTlj21/DU5yxQmCmYrhJ6udQJis4vhmTBkMutU/+vr98o+cvYZLkQtnyH5XTe+XisfKW7iNK6eGICOkenxHf5k883Jk/3lmR6JicLlmSZi9Zfkoz5j+jQTD/MT0RYJStEJ5rO3OEtDXBmbN+JL3hACqcyQfjjKH4tx/jN1EPDVkdLWHuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Get Method\"\n        title=\"Get Method\"\n        src=\"/static/3a9cb19836ad613d4cdd288012acfabc/1e043/Get-Method.png\"\n        srcset=\"/static/3a9cb19836ad613d4cdd288012acfabc/991de/Get-Method.png 173w,\n/static/3a9cb19836ad613d4cdd288012acfabc/e4d6b/Get-Method.png 345w,\n/static/3a9cb19836ad613d4cdd288012acfabc/1e043/Get-Method.png 690w,\n/static/3a9cb19836ad613d4cdd288012acfabc/e3189/Get-Method.png 1035w,\n/static/3a9cb19836ad613d4cdd288012acfabc/e9d87/Get-Method.png 1176w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>그렇다면 GET 메소드의 바디는 존재하지 않아야 하는 것일까?</p>\n<h2 id=\"표준-스펙-살펴보기\" style=\"position:relative;\"><a href=\"#%ED%91%9C%EC%A4%80-%EC%8A%A4%ED%8E%99-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"표준 스펙 살펴보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>표준 스펙 살펴보기</h2>\n<blockquote>\n<p>아래부터는 표준 스펙을 살펴보며 뇌피셜을 곁들여 나름의 해석을 한 것입니다. 개인의 의견이니 실제 사실과는 차이가 있을 수 있습니다.</p>\n</blockquote>\n<p>HTTP는 <a href=\"https://www.ietf.org/\">IETF(Internet Engineering Task Force; 국제 인터넷 표준화 기구)</a>가 관리한다. 그 중 HTTP에 관한 최신 스펙은 RFCs7230~7235 이다. 그 중 <a href=\"https://datatracker.ietf.org/doc/html/rfc7231#section-4.3.1\">RFC7231 - GET Method</a>에 Get 메세지에 대한 설명이 있다.</p>\n<blockquote>\n<p>표준으로 사용하고 있는 다른 스펙이 더 있을 수 있는데, 기존에 사용되었던 RFCs2616이 RFC7230, RFC7231, RFC7232, RFC7233, RFC7234, RFC7235 로 대체되었다는 것을 참조했습니다. - <a href=\"https://datatracker.ietf.org/doc/search?name=2616&#x26;sort=&#x26;rfcs=on&#x26;activedrafts=on&#x26;by=group&#x26;group=\">참조</a></p>\n</blockquote>\n<p>GET 메세지에 대한 설명이 있는 25 페이지 중 다음과 같은 내용이 있다.</p>\n<p><code class=\"language-text\">A payload within a GET request message has no defined semantics; sending a payload body on a GET request might cause some existing implementations to reject the request. -RFC7231 25p</code></p>\n<p>즉, GET 메세지의 payload는 아무런 의미가 없다는 것이다. 따라서 기존 구현체들은 요청을 거부할 수도 있다고 한다. 여기서 얘기하는 구현체들은 아마 서버를 뜻할 것이다. 그렇다면 새로운 구현체들을 사용하면 GET 메세지에 body가 존재해도 된다는 것일까?</p>\n<h3 id=\"message-body와-payload-body\" style=\"position:relative;\"><a href=\"#message-body%EC%99%80-payload-body\" aria-label=\"message body와 payload body permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Message Body와 Payload Body</h3>\n<p>위의 문구로 GET 메세지에 body를 넣어 사용해도 된다고 생각할 수 있다. 하지만, payload와 message는 엄밀히 얘기하면 다르다. payload body와 message body를 구분하면 어떻게 생각할 수 있는지 살펴보자.</p>\n<p><a href=\"https://datatracker.ietf.org/doc/html/rfc7230#section-3.3\">RFC7230 - Message Body</a>에는 메세지 바디에 대한 설명도 있다.</p>\n<p><code class=\"language-text\">and finally a message body containing the payload body (if any, Section 3.3). -RFC7230 7p</code></p>\n<p><code class=\"language-text\">The message body (if any) of an HTTP message is used to carry the payload body of that request or response. The message body is identical to the payload body unless a transfer coding has been applied -RFC7230 28p</code></p>\n<p>message body는 paylaod body를 담는데 사용한다고 한다. 즉, message body와 payload body는 서로 다른 것이다. 하지만 특별한 전송 코딩이 적용되지 않으면 message body와 payload body가 같다고 한다.</p>\n<blockquote>\n<p>여기서 transfer coding은 Transfer-Encoding과 동일시 되어 얘기된다. 즉, message body와 payload body가 동등하다는 것이 아니라, 가지고 있는 값이 같다는 이야기다.</p>\n</blockquote>\n<p><code class=\"language-text\">Request message framing is independent of method semantics, even if the method does not define any use for a message body. -RFC7230 28p</code></p>\n<p>Request 메세지를 만드는 것(framing)은 메소드의 의미와 별개다. 메소드가 message body를 어떻게 사용할지 정의하지 않았어도 Request message는 만들어질 수 있다.</p>\n<p>HTTP Request Message는 다음과 같이 구성된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"http\"><pre class=\"language-http\"><code class=\"language-http\">startline\nHTTP headers\n(empty line)\nbody</code></pre></div>\n<p>즉 HTTP Message는 프로토콜 규격에 맞는 형식이고, 안에 들어오는 실질적인 값이 payload다. 이를 토대로 위의 내용을 다시 정리해보자.</p>\n<p>메소드의 의미와 맞지 않아도 message를 만드는 것 자체는 가능하다. 즉, 메소드와 관계없이 payload body를 message body에 넣을 수 있다.</p>\n<h2 id=\"그래서-해도-돼\" style=\"position:relative;\"><a href=\"#%EA%B7%B8%EB%9E%98%EC%84%9C-%ED%95%B4%EB%8F%84-%EB%8F%BC\" aria-label=\"그래서 해도 돼 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그래서, 해도 돼?</h2>\n<p>결론적으로 할 수는 있다. 그런데 왜 해도되는걸 이렇게 헷갈리게 해놨을까?</p>\n<p>현재 사용되는 RFC723x 이전에는 <a href=\"https://datatracker.ietf.org/doc/html/rfc2616\">RFC2616</a>이 http 스펙으로 사용됐다. 이 문서에 GET의 정보는 Request URI로 구분된다고 되어 있고, 의미가 없는 message body는 무시되어야 한다고 되어 있었다. 물론 이 이전의 문서에서도 비슷한 내용이 담겨있다. 따라서 과거에는 이 표준을 따라 구현된 애플리케이션들이 있었고, 따라서 기존 구현들이 요청을 거부할 수도 있다고 한 것이다.</p>\n<p>보통은 이러한 웹 표준, 특히 HTTP 관련해서는 상호 운용성(interoperability)을 위해서 하위 호환을 철저하게 지킨다. 그럼에도 기존 구현들에서 거부당할 수 있다는 커멘트까지 남기면서 스펙을 바꾼 것이다.</p>\n<hr>\n<p>결론은 할 수 있따 -> 그런데 왜 이렇게 됐을까? -> 옛날 표준에서는 하지 말라고 함 -> 그런데 왜 열었나? -> 필요할 때가 있을 수 있음. 예를 들어 엘라스틱 서치 -> 그럼 써도 되나? -> 우리끼리 쓰는거면 상관없다. -> 외부에 열때는 안 하는게 좋다. 대부분 안 할 것으로 예상할 테니까. -> 그럼에도 해야한다면? 반드시 문서화</p>","excerpt":"현재 WAS 만들기 프로젝트를 진행하고 있다. 당연히 request와 response도 직접 처리하는데, 큰 고민이 생겼다. 'GET 메소드에는 request Body를 넣으면 안 되는 것인가?' 에 관한 것이었다. 문제 상황은 다음과 같다. POST…","timeToRead":4,"fields":{"slug":"/blog/2021-08-09--get-메소드의-body/index.md/"},"frontmatter":{"tags":["http"],"author":{"id":"정대화","bio":"DaeHwa_Jeong@outlook.com"},"title":"Get 메소드의 Body","updatedDate":"2021. 08. 09.","createdDate":"2021. 08. 09."}},"recents":{"edges":[{"node":{"fields":{"slug":"/blog/til/2021-12-07--til-20211205-11/"},"timeToRead":5,"frontmatter":{"tags":["til"],"title":"TIL-20211205~11","author":{"id":"정대화"}}}},{"node":{"fields":{"slug":"/blog/til/2021-12-01--til-20211130-1204/"},"timeToRead":3,"frontmatter":{"tags":["til"],"title":"TIL-20211130~1204","author":{"id":"정대화"}}}},{"node":{"fields":{"slug":"/blog/til/2021-11-17--til-20211116-19/"},"timeToRead":2,"frontmatter":{"tags":["til"],"title":"TIL-20211116~19","author":{"id":"정대화"}}}},{"node":{"fields":{"slug":"/blog/til/2021-11-08--til-20211108-13/"},"timeToRead":6,"frontmatter":{"tags":["til"],"title":"TIL-20211108~13","author":{"id":"정대화"}}}}]}},"pageContext":{"slug":"/blog/2021-08-09--get-메소드의-body/index.md/","dateFormat":"YYYY. MM. DD."}},"staticQueryHashes":[]}