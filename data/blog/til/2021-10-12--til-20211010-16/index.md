---
title: TIL-20211010~16
createdDate: "2021-10-12 01:57:22"
updatedDate: "2021-10-12 01:57:22"
author: 정대화
tags:
  - til
draft: false
---

## 10.10

Im-D 재정비 기간을 가지기로 했다. OS 스터디를 계속 하고 있지만, 특히 최근들어 꾸준히 진행되지 않았다. 지금 생각해보면 꼭 하고 싶다면 날짜나 시간을 바꿔서라도 할 수 있었을텐데 전체적인 에너지가 많이 떨어진 느낌이다. 뭐가 됐든 환기가 필요한 시점인것 같다. 다른 친구들도 관련 얘기를 계속 하긴했지만, 나는 OS를 믿고 외면했던 것 같다. 재정비 기간을 갖고 새로운 원동력을 잘 찾아봐야한다. 그래도 다행인점은 그룹 자체에 애정이 남아있는 것 같다는 점이다. 솔직히 어떻게 이어질지 잘 모르겠다. 그래도 고비를 잘 넘기면 새롭게 나갈 수 있을거라 믿어봐야겠다.

## 10.11

### 객체지향

객체지향의 사실과 오해를 다시 읽기 시작했다. 면접을 보며 객체지향을 좋아한다고 말했고 얼핏 아는 것 처럼 보이지만, 핵심을 꿰뚫지는 못하고 있다는 느낌을 많이 받았다. 특히 간단하게 설명하는 것이 힘들었다.

다시 책을 보니 예전에 했던 생각들이 많이 떠올라 메모를 해뒀다. 블로그를 왜 써야 하는지 다시 한 번 느낀다. 남을 위한 블로그가 아니라 나를 위한 블로그가 우선이라 생각하고 해보자.

### 트랜잭션

코드 리뷰를 하다 트랜잭션을 처리하는 다른 방법이 있지 않을까 해서 좀 더 고민해봤다. 가장 쉬운 방법은 트랜잭션으로 묶을 클래스를 만들고 콜백으로 테스트를 넣어준다. 지금 해놓은 것과 유사한 방식이다.

또 다른 방법은 트랜잭션을 직접 호출하는 것이다. entitymanager에서 트랜잭션을 직접 불러오는 것은 제대로 동작하지 않았다. PersistanceContext로 주입해서 그런 것 같은데 책을 우선 읽어보고 잘 안나오면 테스트를 해봐야 겠다. 검색으로는 못 찾겠다. 아무튼 스프링의 트랜잭션 매니저를 호출해주면 된다. 시작하면서 열어주면 될 것 같지만, BeforeEach의 동작은 순서가 보장되지 않아 문제가 될 수 있다. 콜백을 위한 템플릿 메소드를 만들면 되긴 한데, 어쨌든 부자연스러운 코드가 계속 생긴다.

원하는 것은 개발자가 추가적인 코드 조작 없이 테스트를 진행할 수 있도록 하는 것인데, 어떻게 하는게 좋을지 고민이 많이 필요해보인다. 얘기를 해봐야겠다.

### 테스트병렬화

테스트에 시간이 점점 오래걸려 걱정이라는 얘기가 있었다. 지금 5초정도 되는데 나중에는 1분정도까지 늘어날 것 같다. 그래서 테스트를 병렬로 실행시킬 수 있는 방법을 찾아봤다. 구동 자체는 어렵지 않았는데, 데이터베이스 동시성 처리가 제대로 되지 않아 문제가 생긴다. 좀 더 고민해봐야 할 문제다.

이외의 방법으로는 컨텍스트를 재활용할 수 있도록 만드는 방법이 있다. 이 점을 잘 활용해야 할 것 같다. 그리고 쿼리가 많이 느려지게되면 최적화도 고려해봐야 할 것 같다. <https://devhood.tistory.com/249>
