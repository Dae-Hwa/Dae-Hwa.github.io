---
title: TIL-20220207~11
createdDate: "2022-02-09 00:36:50"
updatedDate: "2022-02-09 00:36:50"
author: 정대화
tags:
  - til
draft: false
---

## 02.07~08

### 인턴1

#### 배치 마무리

배치는 얼추 마무리됐다. 몽고DB는 커서가 없어서 익명클래스로 오버라이딩해서 처리해줬다. 아예 페이지 숫자가 올라가지 않도록 해줬는데, 페이징에서 문제가 생기는게 왜 그런건지 뜯어봐야 할 것 같다. 어쩌면 이런건 배치에 적합한게 아닌걸지도 모르겠다.

이외에도 업데이트가 제대로 안되거나 시간이 안 맞다거나 하는 자잘한걸 해결하는데 시간을 썼다. 이제 고지가 눈앞이라는 생각이 들어서 그런지 마음에 여유가 조금 생겼다. 그러면서도 불안함이 없지는 않다.

#### 키바나?

키바나.. 처음에 내가 이해를 잘 못하는 건줄 알았다. 알고보니 시계열 데이터라 15분 전은 당연히 나오지 않는 것이었다. 어찌어찌 데이터를 보고 그래프도 보고 하긴 했는데, 하는 방법은 대충 알았으니 뭘 보여주냐가 문제가 됐다.

기본적인 틀은 가중치 분석에 필요한 부분과 콜드스타트 분석에 필요한 부분이었다. 그래서 거기에 필요한 항목들을 생각해봤고 이외에도 사용자 입장에서 얼마에 입찰해야 제일 좋을지를 볼 수 있도록 그래프를 보여주는 안도 나왔다.

일단은 마지막 과제로 생각하고 프로젝트 전반적인 마무리를 한 뒤에 잡아가기로 했다.

#### 환경 분리

이번에도 설정 중 가장 어려운 부분이 환경 분리였다. 방법은 많지만 좋은 방법이 뭘지 고민이 많이 된다. 특히 개인적으로는 편의성도 중요한 부분이라 생각하기 때문에 개발에 방해가 되도록 분리가 되지 않았으면 하는 마음이 크다. 그런데 편의성을 잡으려면 더러워지는 부분이 생긴다. 이런걸 깔끔하게 처리하는게 제일 힘든 것 같다.

이번에는 스케줄이 특정 환경에서만 돌아가도록 하기위해 테스트 프로파일을 무조건 붙일 수 있도록 유지하는 방법을 많이 고민했다. 베이스를 반드시 상속받도록 하는 방법도 있겠지만 너무 귀찮다. 그래서 테스트의 리소스 디렉토리에 설정파일을 따로 두고 테스트 프로필을 활성화 시키는 식으로 잡았다. 단점은 이렇게 하면 디렉토리 구조 가이드와는 영 딴판이 된다. 이건 내일 여쭤보면서 풀어야 할 것 같다.

어찌됐건 테스트 데이터베이스를 격리시키는게 주요한 목적이었는데, 엘라스틱서치는 데이터베이스 개념이 아니어서 나누는게 애매했다. 그래서 테스트컨테이너를 사용하는 것 같은데, 현재 상황에서는 나만 도커를 사용하고 있어 추가비용이 생각보다 많이 발생할 수 있다. 그래서 프로퍼티를 이용하는 꼼수를 썼다. 내일 피드백을 받아봐야할 것 같다. ㅋㅋ..

### 코틀린 스터디

이번 주는 타입에 관한 것이었다. let이 헷갈렸는데 옵셔널의 ifPresent와 비슷한 느낌이다.

알고리즘을 풀며 함수형으로 유도한다는 느낌을 많이 받았는데 실제 사용하는 사람들은 dsl을 많이 권장하는 느낌이라고 한다. 나도 계속 써봐야 할 것 같다.

null도 타입처럼 생각하는 것 같다는 의견이 있었는데, 나는 반대로 생각했다. 오히려 코틀린 같은 언어들이 null을 상태처럼 생각해서 다른 타입과 함께 섞어 사용할 수 있는 독립적인 존재로 만든게 아닌가 생각됐다. 예를 들어 자바같은 전통적인 언어는 null이 특정 타입에 값이 없음을 나타내는 하나의 심볼이지만, 코틀린은 null이 있을 수 있다는 표시를 타입과 함께 표기한다. 뇌피셜이니 아직 어디서 주장하기는 어렵다. 정반대로 생각한 것일 수도 있겠다. 어찌됐건 중요한건 널 처리가 매우 깔끔해졌다는 것. 문법적으로 지원을 해버리면서 옵셔널을 엄청 세련되게 표현한 느낌이다.
