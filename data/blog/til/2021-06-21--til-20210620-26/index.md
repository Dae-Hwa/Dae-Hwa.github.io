---
title: TIL-20210620~26
createdDate: "2021-06-21 01:24:36"
updatedDate: "2021-06-21 01:24:36"
author: 정대화
tags:
  - til
draft: false
---

## TODO

- [ ] MockMvc 분석
- [ ] 잭슨 리퀘스트 바디 파싱 분석
- [ ] 스프링 절대경로 서버주소 어떻게 인식하는지(어떻게 nginx 주소를 알 수 있나)?
- [ ] 우아한 객체지향
- [ ] 이런 REST로 괜찮은가
- 알고리즘
  - [ ] [후위표기식](https://www.acmicpc.net/problem/1918)
  - [ ] [스타트택시](https://www.acmicpc.net/problem/19238)
  - [ ] [마법사 상어와 파이어볼](https://www.acmicpc.net/problem/20056)
  - [ ] [행렬](https://www.acmicpc.net/problem/1080)
  - [x] [메뉴 리뉴얼](https://programmers.co.kr/learn/courses/30/lessons/72411)
  - [x] [신규 아이디 추천](https://programmers.co.kr/learn/courses/30/lessons/72410)
  - [ ] [행렬 테두리 회전하기](https://programmers.co.kr/learn/courses/30/lessons/77485)\
  - [ ] [키패드 누르기](https://programmers.co.kr/learn/courses/30/lessons/67256)

- [ ] AWS 강의듣기
  - [ ] IAM 정리하기
- [ ] 데브독스 넥스트(7월 첫주)
- [ ] 엘라스틱서치
- [ ] 서브넷 구분
- [ ] s3 이용
  - [ ] 구현하기
- [ ] 깃헙액션으로 aws 배포
- [ ] classForName 테스트

## 06.20

- 맵으로 카운팅 하는 문제를 풀다 맵을 정렬 하는 방법을 생각해봤다. 엔트리셋은 셋이니까 리스트로 바꿀 수 있다. 이 점을 이용하면 엔트리의 리스트를 뽑아내고 소팅할 수 있다.

- 쓰레드는 유저 쓰레드와 커널 쓰레드로 나뉜다. 보통 사용자는 유저 쓰레드를 사용하는데 커널 쓰레드와 연결시켜야 한다. 모델 중 many to many는 쓰레드 풀에서 꺼내 쓰는 느낌이라 한다. 헷갈렸던 부분은 결국 쓰레드는 프로세스에서 갈라지니까 자식 쓰레드는 모두 같은 커널 영역을 공유하는 것이 아닌가? 하는 것이었다. 메모리적인 측면에서 생각하면 맞는 얘기인데, 해당 모델은 논리적인 얘기다.

- 상속은 나쁜 것이라고 말하는 의견을 종종 봤다. 하지만 상속 자체가 나쁘다기 보다는 잘못 쓰이기 쉽기 때문에 나쁘다고 생각하는게 좋을 것 같다. lsp를 준수하면 클래스 상속을 한 뒤 오버라이딩 하면 안 된다. 잘 생각해보면 이를 강제할 경우 ocp가 만족된다. 이런 측면에서 보면 상속은 다형성과는 별개로 재사용을 위한 것 처럼 보인다. 즉 변하지 않는 부분에 잘 사용하면 효과적이지만, 조심해서 사용해야 하는 부분이 아닌가 싶다.

## 06.21

- 엘라스틱서치는 용량보다는 성능때문에 클러스터링을 한다. 각 노드가 하나의 서버(프로세스)라고 했을때(하나의 서버 안에 여러개의 노드가 있을 수도 있다고 한다), 해당 노드들의 컨테이너를 샤드라고 한다(노드 안에 샤드가 있다). 데이터의 저장 단위는 인덱스인데 이 인덱스를 쪼갠 것을 샤드라고 한다. 샤드는 각 노드에 분산저장된다.

  조회는 모든 샤드에서 수행하고 from + size 크기의 결과를 가져와서 정렬하는데(전체 조회 돼야하지 않나?), 처음에는 점수와 id만 가지고 정렬한다. 이후 정렬 된 값 기반으로 검색 결과를 요청한다. 따라서 랭킹알고리즘이 중요한데, 보통은 TF/IDF, BM25 요즘은 Beats가 추가됐다고 한다.

  역색인이기 때문에 조회 이외의 동작은 속도가 느리다. 따라서 json 문서들을 모아 둔 세그먼트라는 단위를 만들고 이는 불변으로 만들어서 update가 불가능하게 만들어 놓는다. 즉 insert와 delete만 가능하다. delete한 것도 바로 삭제하지 않고 마크를 해놓은 뒤 나중에 지운다.

- 멀티파트에 내가 생각하지 못했던 동작이 들어간다. 임시 값을 이용하여 바운더리라는 구분자를 넣어 데이터를 구분한다. 파일일 경우 데이터마다 컨텐츠의 정보가 달라야하기 때문이다.
